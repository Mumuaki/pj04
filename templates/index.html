{% extends 'base.html' %}

{% block content %}

{% if not user.is_authenticated %}

<div class="search-container">
    <h2>Проверьте комплектацию и технические характеристики техники Силант</h2>
    <form method="get">
        <input type="text" name="serial_number" placeholder="Заводской номер" required>
        <button type="submit" class="auth-btn">Поиск</button>
    </form>
</div>

{% if search_performed %}
{% if search_result %}
<h3>Результат поиска:</h3>
<div class="table-responsive">
    <table>
        <thead>
            <tr>
                <th>Зав. № машины</th>
                <th>Модель техники</th>
                <th>Модель двигателя</th>
                <th>Зав. № двигателя</th>
                <th>Модель трансмиссии</th>
                <th>Зав. № трансмиссии</th>
                <th>Модель ведущего моста</th>
                <th>Зав. № ведущего моста</th>
                <th>Модель управляемого моста</th>
                <th>Зав. № управляемого моста</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>{{ search_result.serial_number }}</td>
                <td>{{ search_result.technique_model }}</td>
                <td>{{ search_result.engine_model }}</td>
                <td>{{ search_result.engine_serial }}</td>
                <td>{{ search_result.transmission_model }}</td>
                <td>{{ search_result.transmission_serial }}</td>
                <td>{{ search_result.drive_axle_model }}</td>
                <td>{{ search_result.drive_axle_serial }}</td>
                <td>{{ search_result.steering_axle_model }}</td>
                <td>{{ search_result.steering_axle_serial }}</td>
            </tr>
        </tbody>
    </table>
</div>
{% else %}
<p style="color: var(--color-red); text-align: center;">{{ not_found_message }}</p>
{% endif %}
{% endif %}


{% else %}

<h2>Информация о Вашей технике</h2>

{% if machines %}
<div class="table-responsive">
    <table>
        <thead>
            <tr>
                <th>Модель техники</th>
                <th>Зав. № машины</th>
                <th>Модель двигателя</th>
                <th>Зав. № двигателя</th>
                <th>Модель трансмиссии</th>
                <th>Зав. № трансмиссии</th>
                <th>Модель ведущего моста</th>
                <th>Зав. № ведущего моста</th>
                <th>Модель управляемого моста</th>
                <th>Зав. № управляемого моста</th>
                <th>Дата отгрузки</th>
                <th>Клиент</th>
                <th>Сервисная компания</th>
            </tr>
        </thead>
        <tbody>
            {% for machine in machines %}
            <tr>
                <td>{{ machine.technique_model }}</td>
                <td>{{ machine.serial_number }}</td>
                <td>{{ machine.engine_model }}</td>
                <td>{{ machine.engine_serial }}</td>
                <td>{{ machine.transmission_model }}</td>
                <td>{{ machine.transmission_serial }}</td>
                <td>{{ machine.drive_axle_model }}</td>
                <td>{{ machine.drive_axle_serial }}</td>
                <td>{{ machine.steering_axle_model }}</td>
                <td>{{ machine.steering_axle_serial }}</td>
                <td>{{ machine.date_shipment|date:"d-m-Y" }}</td>
                <td>{{ machine.client.name }}</td>
                <td>{{ machine.service_company.name }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% else %}
<p>В базе данных пока нет машин, доступных для просмотра.</p>
{% endif %}

{% endif %} {% endblock %}